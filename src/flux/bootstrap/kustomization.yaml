apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - annotations
  - https://github.com/cert-manager/cert-manager/releases/latest/download/cert-manager.yaml
  - https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
  - https://github.com/prometheus-operator/prometheus-operator/releases/latest/download/stripped-down-crds.yaml
  - https://github.com/vlasov-y/node-role-labeler/releases/latest/download/install.yaml

patches:
  - target:
      kind: Deployment
      name: metrics-server
    patch: |-
      - op: add
        path: /spec/template/spec/containers/0/args/-
        value: --kubelet-insecure-tls
